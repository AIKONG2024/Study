from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from sklearn.svm import LinearSVC
from sklearn.linear_model import Perceptron, LogisticRegression
from sklearn.neighbors import KNeighborsClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier , GradientBoostingClassifier
import numpy as np
from xgboost import XGBClassifier

# 1. 데이터
x, y = datasets = load_iris(return_X_y=True)
# print(np.unique(y, return_counts=True))
x_train, x_test, y_train, y_test = train_test_split(x, y, train_size=0.8, random_state=13, stratify=y) 


from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
scaler.fit(x_train)
x_train = scaler.transform(x_train)
x_test = scaler.transform(x_test)

random_state=42
#모델구성
models = [DecisionTreeClassifier(random_state=random_state), RandomForestClassifier(random_state=random_state),
          GradientBoostingClassifier(random_state=random_state), XGBClassifier(random_state=random_state)]
for model in models :

    # 컴파일, 훈련
    model.fit(x_train, y_train)

    # 평가, 예측
    from sklearn.metrics import accuracy_score
    results = model.score(x_test, y_test)
    print(f"[{type(model).__name__}] model.score : ", results)#정확도:  1.0

    x_predict = model.predict(x_test)
    # print(x_predict)
    acc_score = accuracy_score(y_test, x_predict)
    print(f"[{type(model).__name__}] model accuracy_score : ", acc_score)

    print(type(model).__name__ ,":", model.feature_importances_) #중요도/ 낮다고 지우는건 위험함. 성능이 확 떨어짐
    '''
[DecisionTreeClassifier] model acc :  0.9354977510556269
[DecisionTreeClassifier] eval_acc :  0.023407380209289518
DecisionTreeClassifier : [3.39442127e-01 2.67895193e-02 1.61491097e-02 6.38112532e-02
 4.59779504e-02 1.48727425e-01 2.96800143e-02 3.43428717e-02
 2.32644172e-02 1.39328065e-01 9.53149354e-03 3.24139016e-03
 1.37127168e-02 1.54360784e-03 1.97441002e-04 9.78680297e-03
 1.82049214e-03 1.23846910e-02 6.65748987e-04 2.87936871e-04
 0.00000000e+00 8.94287490e-06 1.13242350e-04 3.23918502e-03
 1.64786312e-03 6.90563350e-04 2.84676793e-03 7.92097944e-05
 7.08684554e-06 1.31514855e-03 1.02389250e-03 0.00000000e+00
 9.60585831e-04 2.94139721e-03 6.17084336e-04 8.77530543e-03
 9.64671095e-03 4.93393094e-03 5.28966417e-05 2.53905817e-04
 1.01070100e-03 9.88376668e-05 7.38862995e-03 2.40154665e-03
 4.08240960e-03 1.17546718e-02 5.44091170e-03 1.94390611e-04
 1.03041703e-03 2.23316356e-05 2.46072266e-04 2.11787506e-03
 3.33561810e-03 1.03679276e-03]
[RandomForestClassifier] model acc :  0.9530073893886543
[RandomForestClassifier] eval_acc :  0.012937167248026437
RandomForestClassifier : [2.41142814e-01 4.84005280e-02 3.35813784e-02 6.06399684e-02
 5.74873353e-02 1.16797484e-01 4.17864633e-02 4.34186381e-02
 4.18574917e-02 1.10063698e-01 1.11927512e-02 6.01664457e-03
 1.20399502e-02 2.81708261e-02 1.22172823e-03 9.16689454e-03
 2.42991438e-03 1.19787661e-02 4.11160060e-04 2.52784448e-03
 1.24366086e-05 3.82434144e-05 1.15512895e-04 1.35766195e-02
 2.82693380e-03 9.67327550e-03 4.03351467e-03 3.90985079e-04
 6.17198659e-06 8.46956860e-04 1.73165134e-03 3.10767516e-04
 9.56637925e-04 1.87867303e-03 8.23907930e-04 1.58601243e-02
 9.89864798e-03 4.08422552e-03 1.50923629e-04 3.77999720e-04
 7.19276437e-04 1.81103843e-04 5.86450606e-03 3.17115132e-03
 3.75166922e-03 5.49929293e-03 4.42485083e-03 5.89194780e-04
 1.43610338e-03 8.58010998e-05 5.89022348e-04 1.04638336e-02
 1.03578260e-02 4.93987991e-03]
[GradientBoostingClassifier] model acc :  0.773304112355425
[GradientBoostingClassifier] eval_acc :  0.08256838626767028
GradientBoostingClassifier : [6.47686031e-01 7.74361889e-03 1.29994911e-03 3.93090140e-02
 1.00047765e-02 5.62957770e-02 7.04808830e-03 2.62354240e-02
 2.87791101e-03 4.12730663e-02 2.48834162e-02 5.87975376e-03
 1.36656700e-02 1.36180822e-03 3.04447712e-04 1.25212880e-02
 4.65083282e-03 1.69147902e-02 9.86779257e-04 1.61060005e-03
 0.00000000e+00 4.10506999e-05 5.22488048e-05 2.15309506e-03
 1.23504704e-03 6.62947042e-03 1.21305342e-03 3.77846463e-04
 4.69951518e-06 4.67887628e-04 1.09850893e-03 4.62561727e-05
 2.78686181e-04 1.37169332e-03 1.05837590e-03 1.66882703e-02
 1.17389463e-02 1.39779280e-03 6.23440528e-05 2.48525019e-05
 1.36005807e-03 2.16923964e-05 4.00509419e-03 1.79830062e-03
 3.09967590e-03 7.50036254e-03 4.27543856e-04 7.26062111e-04
 1.16838937e-03 6.36452856e-05 9.11215182e-04 3.18709117e-03
 6.24346884e-03 9.94232941e-04]
[XGBClassifier] model acc :  0.8675073434918303
[XGBClassifier] eval_acc :  0.049430879383146685
XGBClassifier : [0.09656484 0.00657146 0.00479971 0.01343889 0.00758214 0.01351817
 0.00860704 0.0106945  0.00529269 0.01245664 0.06054551 0.03397398
 0.02999688 0.02576792 0.00321637 0.04450757 0.01892221 0.03937379
 0.0052693  0.00632144 0.00202231 0.00823559 0.01194793 0.0143356
 0.01097279 0.04755393 0.01018816 0.00347637 0.00089977 0.00694938
 0.01111117 0.00554481 0.00518294 0.01313673 0.02005442 0.05213469
 0.02718747 0.01563347 0.0051419  0.00663766 0.01787025 0.00300196
 0.02991172 0.01943109 0.02506068 0.04258135 0.01652389 0.00527649
 0.01371489 0.00293669 0.00845273 0.02995467 0.04661062 0.01290482]
    '''